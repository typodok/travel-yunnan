<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Book Your Travel Experience – Yunjian</title>
 <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="stylesheet" href="css/travel.css" />
  <link rel="stylesheet" href="css/responsive.css" />
  <link rel="stylesheet" href="css/booking.css" />
  <!-- Add flatpickr CSS for date picker -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>
<body>
  <header class="hero">
    <nav class="nav">
      <a href="index.html">Home</a>
      <div class="dropdown">
        <a href="#">Our Services ▼</a>
        <div class="dropdown-content">
          <a href="travel-assistance.html">Travel Assistance</a>
          <a href="#local-experiences">Local Experiences</a>
          <a href="customized-tours.html">Customized Tours</a>
        </div>
      </div>
       <a href="about.html">About</a>
      <a href="about.html#contact">Contact</a>
    </nav>
  </header>
  <main>
    <div class="background-carousel">
      <div class="carousel-images">
        <img src="images/landing/landing_01.webp" class="carousel-slide active" />
        <img src="images/landing/landing_02.webp" class="carousel-slide" />
        <img src="images/landing/landing_03.webp" class="carousel-slide" />
        <img src="images/landing/landing_04.webp" class="carousel-slide" />
        <img src="images/landing/landing_05.webp" class="carousel-slide" />
        <img src="images/landing/landing_06.webp" class="carousel-slide" />
        <img src="images/landing/landing_07.webp" class="carousel-slide" />
      </div>
      <div class="gradient-overlay"></div>
      <section class="booking-section">
        <h2 id="booking-title">Book Your Experience</h2>
        <p id="booking-subtitle">Fill out the form below and we'll get back to you within 24 hours</p>
        
        <!-- Added tour selection display -->
        <div id="selected-tour" class="selected-tour" style="display: none;">
          <h3>Selected Tour: <span id="tour-name-display"></span></h3>
        </div>
        
        <div class="booking-form">
          <!-- Netlify Forms: Added name attribute and data-netlify attribute -->
          <form id="booking-form" name="booking" method="POST" data-netlify="true">
            <!-- Netlify Forms: Added hidden field for form name -->
            <input type="hidden" name="form-name" value="booking" />
            
            <!-- Hidden fields to capture service type -->
            <input type="hidden" id="service-type" name="service" value="">
            <input type="hidden" id="service-level" name="level" value="">
            <input type="hidden" id="tour-name" name="tour" value="">
            
            <div class="form-group">
              <label for="name">Full Name *</label>
              <input type="text" id="name" name="name" required>
            </div>
            
            <div class="form-group">
              <label for="email">Email Address *</label>
              <input type="email" id="email" name="email" required>
            </div>
            
            <div class="form-group">
              <label for="travelers">Number of Travelers *</label>
              <select id="travelers" name="travelers" required>
                <option value="">Select number</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5+">5+</option>
              </select>
            </div>
            
            <!-- Replaced dates and duration with date range picker -->
            <div class="form-group">
              <label for="date-range">Travel Dates *</label>
              <input type="text" id="date-range" name="date-range" placeholder="Select your travel dates" required>
              <div id="duration-display" class="duration-display" style="display: none;">
                Duration: <span id="duration-days"></span> days
              </div>
            </div>
            
            <div class="form-group" id="special-requests-group">
              <label for="special-requests">Special Requests or Questions</label>
              <textarea id="special-requests" name="special-requests" rows="4" placeholder="Tell us about your preferences, dietary restrictions, accessibility needs, etc."></textarea>
            </div>
            
            <button type="submit" class="submit-btn">Submit Booking Request</button>
          </form>
          
          <div class="booking-confirmation" id="booking-confirmation" style="display: none;">
            <h3>Thank You!</h3>
            <p>Your booking request has been submitted successfully. We'll get back to you within 24 hours to confirm details and payment.</p>
          </div>
        </div>
      </section>
    </div>
  </main>
  
  <div class="footer-dotmesh-transition"></div>
  <footer class="footer">
    <p>© 2025 Yunjian. All rights reserved.</p>
    <div class="social-links">
      <a href="#">Facebook</a>
      <a href="#">Instagram</a>
      <a href="#">Twitter</a>
    </div>
  </footer>
  
  <script src="js/booking-carousel.js"></script>
  <!-- Add flatpickr JS for date picker -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script>
    // Parse URL parameters to pre-fill the form
    document.addEventListener('DOMContentLoaded', function() {
      const urlParams = new URLSearchParams(window.location.search);
      const service = urlParams.get('service');
      const level = urlParams.get('level');
      const tour = urlParams.get('tour');
      
      // Set hidden fields
      if (service) document.getElementById('service-type').value = service;
      if (level) document.getElementById('service-level').value = level;
      if (tour) {
        document.getElementById('tour-name').value = tour;
        
        // Display the selected tour name with proper formatting
        const selectedTourDiv = document.getElementById('selected-tour');
        const tourNameDisplay = document.getElementById('tour-name-display');
        
        // Convert tour slug to proper name
        let properTourName = tour;
        if (tour === 'slow-life-kunming') {
          properTourName = 'Slow Life in Kunming';
        } else if (tour === 'mountain-retreat') {
          properTourName = 'Mountain Retreat Experience';
        } else if (tour === 'cultural-journey') {
          properTourName = 'Cultural Journey Through Yunnan';
        } else if (tour === 'river-expedition') {
          properTourName = 'Li River Expedition';
        } else if (tour === 'ancient-villages') {
          properTourName = 'Ancient Villages Discovery';
        } else if (tour === 'food-adventure') {
          properTourName = 'Culinary Adventure';
        } else {
          // Fallback: convert any slug to proper case
          properTourName = tour.replace(/-/g, ' ')
            .replace(/\b\w/g, l => l.toUpperCase());
        }
        
        tourNameDisplay.textContent = properTourName;
        selectedTourDiv.style.display = 'block';
      }
      
      // Update page title and subtitle based on service type
      const titleElement = document.getElementById('booking-title');
      const subtitleElement = document.getElementById('booking-subtitle');
      
      if (service === 'travel-plans') {
        titleElement.textContent = 'Book Curated Travel Plans';
        subtitleElement.textContent = 'Get your personalized travel itinerary in just 24 hours';
      } else if (service === 'personalized-itinerary') {
        titleElement.textContent = 'Book Personalized Itinerary';
        subtitleElement.textContent = 'Let us create a custom journey based on your preferences';
      } else if (service === 'travel-concierge') {
        titleElement.textContent = 'Book Full Travel Concierge';
        subtitleElement.textContent = 'Enjoy worry-free travel with 24/7 support throughout your journey';
      } else if (service === 'local-experience') {
        titleElement.textContent = 'Book Local Experience';
        subtitleElement.textContent = 'Join our expert guides for an authentic local experience';
      } else {
        titleElement.textContent = 'Book Your Experience';
        subtitleElement.textContent = 'Fill out the form below and we\'ll get back to you within 24 hours';
      }
      
      // Initialize date range picker
      flatpickr("#date-range", {
        mode: "range",
        dateFormat: "Y-m-d",
        minDate: "today",
        onChange: function(selectedDates, dateStr, instance) {
          if (selectedDates.length === 2) {
            const startDate = selectedDates[0];
            const endDate = selectedDates[1];
            const diffTime = Math.abs(endDate - startDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
            
            // Display duration
            document.getElementById('duration-days').textContent = diffDays;
            document.getElementById('duration-display').style.display = 'block';
          } else {
            document.getElementById('duration-display').style.display = 'none';
          }
        }
      });
      
     // Handle form submission
const form = document.getElementById('booking-form');
const confirmation = document.getElementById('booking-confirmation');

form.addEventListener('submit', function(e) {
  e.preventDefault();
  
  // Create a new FormData object
  const formData = new FormData(form);
  
  // Submit the form using fetch with Netlify's endpoint
  fetch('/', {
    method: 'POST',
    headers: { "Content-Type": "application/x-www-form-urlencoded" },
    body: new URLSearchParams(formData).toString()
  })
  .then(response => {
    if (response.ok) {
      // Show confirmation message
      form.style.display = 'none';
      confirmation.style.display = 'block';
      
      // Scroll to confirmation message
      confirmation.scrollIntoView({ behavior: 'smooth' });
    } else {
      throw new Error('Network response was not ok.');
    }
  })
  .catch(error => {
    console.error('Error:', error);
    alert('There was an error submitting your booking. Please try again.');
  });
});
    });
  </script>
</body>
</html>